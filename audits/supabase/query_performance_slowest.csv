query,calls,mean_time_ms,max_time_ms,total_time_ms,rows
"with tables as (
SELECT
  c.oid :: int8 AS id,
  nc.nspname AS schema,
  c.relname AS name,
  c.relrowsecurity AS rls_enabled,
  c.relforcerowsecurity AS rls_forced,
  CASE
    WHEN c.relreplident = $1 THEN $2
    WHEN c.relreplident = $3 THEN $4
    WHEN c.relreplident = $5 THEN $6
    ELSE $7
  END AS replica_identity,
  pg_total_relation_size(format($8, nc.nspname, c.relname)) :: int8 AS bytes,
  pg_size_pretty(
    pg_total_relation_size(format($9, nc.nspname, c.relname))
  ) AS size,
  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,
  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,
  obj_description(c.oid) AS comment,
  coalesce(pk.primary_keys, $10) as primary_keys,
  coalesce(
    jsonb_agg(relationships) filter (where relationships is not null),
    $11
  ) as relationships
FROM
  pg_namespace nc
  JOIN pg_class c ON nc.oid = c.relnamespace
  left join (
    select
      c.oid::int8 as table_id,
      jsonb_agg(
        jsonb_build_object(
          $12, c.oid::int8,
          $13, n.nspname,
          $14, c.relname,
          $15, a.attname
        )
        order by array_position(i.indkey, a.attnum)
      ) as primary_keys
    from
      pg_index i
      join pg_class c on i.indrelid = c.oid
      join pg_namespace n on c.relnamespace = n.oid
      join pg_attribute a on a.attrelid = c.oid and a.attnum = any(i.indkey)
    where
      n.nspname IN ($16) AND
      
      i.indisprimary
    group by c.oid
  ) as pk
  on pk.table_id = c.oid
  left join (
    select
      c.oid :: int8 as id,
      c.conname as constraint_name,
      nsa.nspname as source_schema,
      csa.relname as source_table_name,
      sa.attname as source_column_name,
      nta.nspname as target_table_schema,
      cta.relname as target_table_name,
      ta.attname as target_column_name
    from
      pg_constraint c
    join (
      pg_attribute sa
      join pg_class csa on sa.attrelid = csa.oid
      join pg_namespace nsa on csa.relnamespace = nsa.oid
    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)
    join (
      pg_attribute ta
      join pg_class cta on ta.attrelid = cta.oid
      join pg_namespace nta on cta.relnamespace = nta.oid
    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)
    where
      nsa.nspname IN ($17) OR nta.nspname IN ($18) AND
      
      c.contype = $19
  ) as relationships
  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)
  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)
WHERE
  nc.nspname IN ($20) AND
  
  
  c.relkind IN ($21, $22)
  AND NOT pg_is_other_temp_schema(nc.oid)
  AND (
    pg_has_role(c.relowner, $23)
    OR has_table_privilege(
      c.oid,
      $24
    )
    OR has_any_column_privilege(c.oid, $25)
  )
group by
  c.oid,
  c.relname,
  c.relrowsecurity,
  c.relforcerowsecurity,
  c.relreplident,
  nc.nspname,
  pk.primary_keys


)
  , columns as (
-- Adapted from information_schema.columns

SELECT
  c.oid :: int8 AS table_id,
  nc.nspname AS schema,
  c.relname AS table,
  (c.oid || $26 || a.attnum) AS id,
  a.attnum AS ordinal_position,
  a.attname AS name,
  CASE
    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)
    ELSE $27
  END AS default_value,
  CASE
    WHEN t.typtype = $28 THEN CASE
      WHEN bt.typelem <> $29 :: oid
      AND bt.typlen = $30 THEN $31
      WHEN nbt.nspname = $32 THEN format_type(t.typbasetype, $33)
      ELSE $34
    END
    ELSE CASE
      WHEN t.typelem <> $35 :: oid
      AND t.typlen = $36 THEN $37
      WHEN nt.nspname = $38 THEN format_type(a.atttypid, $39)
      ELSE $40
    END
  END AS data_type,
  COALESCE(bt.typname, t.typname) AS format,
  a.attidentity IN ($41, $42) AS is_identity,
  CASE
    a.attidentity
    WHEN $43 THEN $44
    WHEN $45 THEN $46
    ELSE $47
  END AS identity_generation,
  a.attgenerated IN ($48) AS is_generated,
  NOT (
    a.attnotnull
    OR t.typtype = $49 AND t.typnotnull
  ) AS is_nullable,
  (
    c.relkind IN ($50, $51)
    OR c.relkind IN ($52, $53) AND pg_column_is_updatable(c.oid, a.attnum, $54)
  ) AS is_updatable,
  uniques.table_id IS NOT NULL AS is_unique,
  check_constraints.definition AS ""check"",
  array_to_json(
    array(
      SELECT
        enumlabel
      FROM
        pg_catalog.pg_enum enums
      WHERE
        enums.enumtypid = coalesce(bt.oid, t.oid)
        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)
      ORDER BY
        enums.enumsortorder
    )
  ) AS enums,
  col_description(c.oid, a.attnum) AS comment
FROM
  pg_attribute a
  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid
  AND a.attnum = ad.adnum
  JOIN (
    pg_class c
    JOIN pg_namespace nc ON c.relnamespace = nc.oid
  ) ON a.attrelid = c.oid
  JOIN (
    pg_type t
    JOIN pg_namespace nt ON t.typnamespace = nt.oid
  ) ON a.atttypid = t.oid
  LEFT JOIN (
    pg_type bt
    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid
  ) ON t.typtype = $55
  AND t.typbasetype = bt.oid
  LEFT JOIN (
    SELECT DISTINCT ON (table_id, ordinal_position)
      conrelid AS table_id,
      conkey[$56] AS ordinal_position
    FROM pg_catalog.pg_constraint
    WHERE contype = $57 AND cardinality(conkey) = $58
  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum
  LEFT JOIN (
    -- We only select the first column check
    SELECT DISTINCT ON (table_id, ordinal_position)
      conrelid AS table_id,
      conkey[$59] AS ordinal_position,
      substring(
        pg_get_constraintdef(pg_constraint.oid, $60),
        $61,
        length(pg_get_constraintdef(pg_constraint.oid, $62)) - $63
      ) AS ""definition""
    FROM pg_constraint
    WHERE contype = $64 AND cardinality(conkey) = $65
    ORDER BY table_id, ordinal_position, oid asc
  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum
WHERE
  nc.nspname IN ($66) AND
  
  
  
  
  NOT pg_is_other_temp_schema(nc.oid)
  AND a.attnum > $67
  AND NOT a.attisdropped
  AND (c.relkind IN ($68, $69, $70, $71, $72))
  AND (
    pg_has_role(c.relowner, $73)
    OR has_column_privilege(
      c.oid,
      a.attnum,
      $74
    )
  )


)
select
  *
  , 
COALESCE(
  (
    SELECT
      array_agg(row_to_json(columns)) FILTER (WHERE columns.table_id = tables.id)
    FROM
      columns
  ),
  $75
) AS columns
from tables",55,734.269935090909,1384.405776,40384.84643,3969
"with views as (
SELECT
  c.oid :: int8 AS id,
  n.nspname AS schema,
  c.relname AS name,
  -- See definition of information_schema.views
  (pg_relation_is_updatable(c.oid, $1) & $2) = $3 AS is_updatable,
  obj_description(c.oid) AS comment
FROM
  pg_class c
  JOIN pg_namespace n ON n.oid = c.relnamespace
WHERE
  n.nspname IN ($4) AND
  
  
  c.relkind = $5


)
  , columns as (
-- Adapted from information_schema.columns

SELECT
  c.oid :: int8 AS table_id,
  nc.nspname AS schema,
  c.relname AS table,
  (c.oid || $6 || a.attnum) AS id,
  a.attnum AS ordinal_position,
  a.attname AS name,
  CASE
    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)
    ELSE $7
  END AS default_value,
  CASE
    WHEN t.typtype = $8 THEN CASE
      WHEN bt.typelem <> $9 :: oid
      AND bt.typlen = $10 THEN $11
      WHEN nbt.nspname = $12 THEN format_type(t.typbasetype, $13)
      ELSE $14
    END
    ELSE CASE
      WHEN t.typelem <> $15 :: oid
      AND t.typlen = $16 THEN $17
      WHEN nt.nspname = $18 THEN format_type(a.atttypid, $19)
      ELSE $20
    END
  END AS data_type,
  COALESCE(bt.typname, t.typname) AS format,
  a.attidentity IN ($21, $22) AS is_identity,
  CASE
    a.attidentity
    WHEN $23 THEN $24
    WHEN $25 THEN $26
    ELSE $27
  END AS identity_generation,
  a.attgenerated IN ($28) AS is_generated,
  NOT (
    a.attnotnull
    OR t.typtype = $29 AND t.typnotnull
  ) AS is_nullable,
  (
    c.relkind IN ($30, $31)
    OR c.relkind IN ($32, $33) AND pg_column_is_updatable(c.oid, a.attnum, $34)
  ) AS is_updatable,
  uniques.table_id IS NOT NULL AS is_unique,
  check_constraints.definition AS ""check"",
  array_to_json(
    array(
      SELECT
        enumlabel
      FROM
        pg_catalog.pg_enum enums
      WHERE
        enums.enumtypid = coalesce(bt.oid, t.oid)
        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)
      ORDER BY
        enums.enumsortorder
    )
  ) AS enums,
  col_description(c.oid, a.attnum) AS comment
FROM
  pg_attribute a
  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid
  AND a.attnum = ad.adnum
  JOIN (
    pg_class c
    JOIN pg_namespace nc ON c.relnamespace = nc.oid
  ) ON a.attrelid = c.oid
  JOIN (
    pg_type t
    JOIN pg_namespace nt ON t.typnamespace = nt.oid
  ) ON a.atttypid = t.oid
  LEFT JOIN (
    pg_type bt
    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid
  ) ON t.typtype = $35
  AND t.typbasetype = bt.oid
  LEFT JOIN (
    SELECT DISTINCT ON (table_id, ordinal_position)
      conrelid AS table_id,
      conkey[$36] AS ordinal_position
    FROM pg_catalog.pg_constraint
    WHERE contype = $37 AND cardinality(conkey) = $38
  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum
  LEFT JOIN (
    -- We only select the first column check
    SELECT DISTINCT ON (table_id, ordinal_position)
      conrelid AS table_id,
      conkey[$39] AS ordinal_position,
      substring(
        pg_get_constraintdef(pg_constraint.oid, $40),
        $41,
        length(pg_get_constraintdef(pg_constraint.oid, $42)) - $43
      ) AS ""definition""
    FROM pg_constraint
    WHERE contype = $44 AND cardinality(conkey) = $45
    ORDER BY table_id, ordinal_position, oid asc
  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum
WHERE
  nc.nspname IN ($46) AND
  
  
  
  
  NOT pg_is_other_temp_schema(nc.oid)
  AND a.attnum > $47
  AND NOT a.attisdropped
  AND (c.relkind IN ($48, $49, $50, $51, $52))
  AND (
    pg_has_role(c.relowner, $53)
    OR has_column_privilege(
      c.oid,
      a.attnum,
      $54
    )
  )


)
select
  *
  , 
COALESCE(
  (
    SELECT
      array_agg(row_to_json(columns)) FILTER (WHERE columns.table_id = views.id)
    FROM
      columns
  ),
  $55
) AS columns
from views",50,648.9689842,1199.324807,32448.44921,3347
"with f as (
      
-- CTE with sane arg_modes, arg_names, and arg_types.
-- All three are always of the same length.
-- All three include all args, including OUT and TABLE args.
with functions as (
  select
    *,
    -- proargmodes is null when all arg modes are IN
    coalesce(
      p.proargmodes,
      array_fill($1::text, array[cardinality(coalesce(p.proallargtypes, p.proargtypes))])
    ) as arg_modes,
    -- proargnames is null when all args are unnamed
    coalesce(
      p.proargnames,
      array_fill($2::text, array[cardinality(coalesce(p.proallargtypes, p.proargtypes))])
    ) as arg_names,
    -- proallargtypes is null when all arg modes are IN
    coalesce(p.proallargtypes, p.proargtypes) as arg_types,
    array_cat(
      array_fill($3, array[pronargs - pronargdefaults]),
      array_fill($4, array[pronargdefaults])) as arg_has_defaults
  from
    pg_proc as p
  where
    p.prokind = $5
)
select
  f.oid as id,
  n.nspname as schema,
  f.proname as name,
  l.lanname as language,
  case
    when l.lanname = $6 then $7
    else f.prosrc
  end as definition,
  case
    when l.lanname = $8 then f.prosrc
    else pg_get_functiondef(f.oid)
  end as complete_statement,
  coalesce(f_args.args, $9) as args,
  pg_get_function_arguments(f.oid) as argument_types,
  pg_get_function_identity_arguments(f.oid) as identity_argument_types,
  f.prorettype as return_type_id,
  pg_get_function_result(f.oid) as return_type,
  nullif(rt.typrelid, $10) as return_type_relation_id,
  f.proretset as is_set_returning_function,
  case
    when f.provolatile = $11 then $12
    when f.provolatile = $13 then $14
    when f.provolatile = $15 then $16
  end as behavior,
  f.prosecdef as security_definer,
  f_config.config_params as config_params
from
  functions f
  left join pg_namespace n on f.pronamespace = n.oid
  left join pg_language l on f.prolang = l.oid
  left join pg_type rt on rt.oid = f.prorettype
  left join (
    select
      oid,
      jsonb_object_agg(param, value) filter (where param is not null) as config_params
    from
      (
        select
          oid,
          (string_to_array(unnest(proconfig), $17))[$18] as param,
          (string_to_array(unnest(proconfig), $19))[$20] as value
        from
          functions
      ) as t
    group by
      oid
  ) f_config on f_config.oid = f.oid
  left join (
    select
      oid,
      jsonb_agg(jsonb_build_object(
        $21, t2.mode,
        $22, name,
        $23, type_id,
        -- Cast null into false boolean
        $24, COALESCE(has_default, $25)
      )) as args
    from
      (
        select
          oid,
          unnest(arg_modes) as mode,
          unnest(arg_names) as name,
          -- Coming from: coalesce(p.proallargtypes, p.proargtypes) postgres won't automatically assume
          -- integer, we need to cast it to be properly parsed
          unnest(arg_types)::int8 as type_id,
          unnest(arg_has_defaults) as has_default
        from
          functions
      ) as t1,
      lateral (
        select
          case
            when t1.mode = $26 then $27
            when t1.mode = $28 then $29
            when t1.mode = $30 then $31
            when t1.mode = $32 then $33
            else $34
          end as mode
      ) as t2
    group by
      t1.oid
  ) f_args on f_args.oid = f.oid

    )
    select
      f.*
    from f
   where schema NOT IN ($35,$36,$37)

-- source: dashboard
-- user: 8075c1a2-da12-4dce-901d-1b970a3e0101
-- date: 2026-02-01T06:23:07.129Z",56,518.691245232143,1137.156924,29046.709733,27529
"ALTER TABLE public.avatars ADD COLUMN is_preset bool
    DEFAULT 'false'
    NOT NULL",1,420.238451,420.238451,420.238451,0
"COPY  ( select n.nspname as schema, p.proname as function, pg_get_functiondef ( p.oid ) as definition from pg_proc p join pg_namespace n on n.oid = p.pronamespace where n.nspname not in ( 'pg_catalog' , 'information_schema' ) order by n.nspname, p.proname ) TO STDOUT WITH CSV HEADER",1,405.91149,405.91149,405.91149,496
"-- QUERY 1: Tables + columns + constraints + indexes + triggers + RLS flags + size
WITH tables AS (
  SELECT
    c.oid                                         AS table_oid,
    n.nspname                                     AS schema_name,
    c.relname                                     AS table_name,
    c.reltuples                                   AS approx_rows,
    c.relrowsecurity                              AS rls_enabled,
    c.relforcerowsecurity                         AS rls_forced,
    pg_total_relation_size(c.oid)                 AS total_bytes,
    pg_relation_size(c.oid)                       AS table_bytes,
    pg_indexes_size(c.oid)                        AS index_bytes,
    obj_description(c.oid, $1)            AS table_comment
  FROM pg_class c
  JOIN pg_namespace n ON n.oid = c.relnamespace
  WHERE c.relkind = $2 -- ordinary tables
    AND n.nspname IN ($3, $4)
)
SELECT
  t.schema_name,
  t.table_name,
  t.table_comment,
  t.rls_enabled,
  t.rls_forced,
  t.approx_rows,
  t.total_bytes,
  t.table_bytes,
  t.index_bytes,

  -- columns
  (
    SELECT jsonb_agg(
      jsonb_build_object(
        $5, a.attnum,
        $6, a.attname,
        $7, pg_catalog.format_type(a.atttypid, a.atttypmod),
        $8, a.attnotnull,
        $9, pg_get_expr(ad.adbin, ad.adrelid),
        $10, a.attidentity,
        $11, a.attgenerated
      )
      ORDER BY a.attnum
    )
    FROM pg_attribute a
    LEFT JOIN pg_attrdef ad
      ON ad.adrelid = a.attrelid AND ad.adnum = a.attnum
    WHERE a.attrelid = t.table_oid
      AND a.attnum > $12
      AND NOT a.attisdropped
  ) AS columns,

  -- constraints (pk/uk/fk/check)
  (
    SELECT jsonb_agg(
      jsonb_build_object(
        $13, con.conname,
        $14, con.contype,
        $15, pg_get_constraintdef(con.oid, $16)
      )
      ORDER BY con.conname
    )
    FROM pg_constraint con
    WHERE con.conrelid = t.table_oid
  ) AS constraints,

  -- indexes
  (
    SELECT jsonb_agg(
      jsonb_build_object(
        $17, i.relname,
        $18, pg_get_indexdef(i.oid)
      )
      ORDER BY i.relname
    )
    FROM pg_index ix
    JOIN pg_class i ON i.oid = ix.indexrelid
    WHERE ix.indrelid = t.table_oid
  ) AS indexes,

  -- triggers (excluding internal)
  (
    SELECT jsonb_agg(
      jsonb_build_object(
        $19, tg.tgname,
        $20, tg.tgenabled,
        $21, pg_get_triggerdef(tg.oid, $22)
      )
      ORDER BY tg.tgname
    )
    FROM pg_trigger tg
    WHERE tg.tgrelid = t.table_oid
      AND NOT tg.tgisinternal
  ) AS triggers

FROM tables t
ORDER BY t.schema_name, t.table_name",1,381.49694,381.49694,381.49694,112
DROP SCHEMA IF EXISTS public CASCADE,1,354.783696,354.783696,354.783696,0
"-- QUERY 2: RPCs / Functions (definitions + args + return type + security + volatility)
SELECT
  n.nspname                                                      AS schema_name,
  p.proname                                                      AS function_name,
  p.oid                                                          AS function_oid,
  pg_get_userbyid(p.proowner)                                    AS owner,
  p.prosecdef                                                    AS security_definer,
  p.provolatile                                                  AS volatility,      -- i=immutable, s=stable, v=volatile
  pg_get_function_identity_arguments(p.oid)                      AS identity_args,
  pg_get_function_arguments(p.oid)                               AS full_args,
  pg_catalog.format_type(p.prorettype, $1)                     AS return_type,
  pg_get_functiondef(p.oid)                                      AS definition
FROM pg_proc p
JOIN pg_namespace n ON n.oid = p.pronamespace
WHERE n.nspname IN ($2, $3)
  AND p.prokind = $4 -- function (not procedure/aggregate/window)
  AND p.proname NOT LIKE $5
ORDER BY n.nspname, p.proname, identity_args",1,274.966629,274.966629,274.966629,387
"ALTER TABLE public.organizations
    ADD COLUMN IF NOT EXISTS mission_statement text,
    ADD COLUMN IF NOT EXISTS headquarters text,
    ADD COLUMN IF NOT EXISTS logo_url text",1,269.306295,269.306295,269.306295,0
"-- QUERY 3: RLS policies + table grants + routine grants (single JSON output)
WITH tbl AS (
  SELECT
    c.oid                                 AS table_oid,
    n.nspname                             AS schema_name,
    c.relname                             AS table_name,
    c.relrowsecurity                      AS rls_enabled,
    c.relforcerowsecurity                 AS rls_forced
  FROM pg_class c
  JOIN pg_namespace n ON n.oid = c.relnamespace
  WHERE c.relkind = $1
    AND n.nspname IN ($2, $3)
),
pol AS (
  SELECT
    schemaname,
    tablename,
    jsonb_agg(
      jsonb_build_object(
        $4, policyname,
        $5, permissive,
        $6, roles,
        $7, cmd,
        $8, qual,
        $9, with_check
      )
      ORDER BY policyname
    ) AS policies
  FROM pg_policies
  WHERE schemaname IN ($10, $11)
  GROUP BY schemaname, tablename
),
table_grants AS (
  SELECT
    table_schema,
    table_name,
    jsonb_agg(
      jsonb_build_object(
        $12, grantee,
        $13, privilege_type,
        $14, is_grantable
      )
      ORDER BY grantee, privilege_type
    ) AS grants
  FROM information_schema.role_table_grants
  WHERE table_schema IN ($15, $16)
  GROUP BY table_schema, table_name
),
routine_grants AS (
  SELECT
    routine_schema,
    routine_name,
    jsonb_agg(
      jsonb_build_object(
        $17, grantee,
        $18, privilege_type,
        $19, is_grantable
      )
      ORDER BY grantee, privilege_type
    ) AS grants
  FROM information_schema.role_routine_grants
  WHERE routine_schema IN ($20, $21)
  GROUP BY routine_schema, routine_name
)
SELECT jsonb_build_object(
  $22, (
    SELECT jsonb_agg(
      jsonb_build_object(
        $23, t.schema_name,
        $24, t.table_name,
        $25, t.rls_enabled,
        $26, t.rls_forced,
        $27, COALESCE(p.policies, $28::jsonb),
        $29, COALESCE(g.grants, $30::jsonb)
      )
      ORDER BY t.schema_name, t.table_name
    )
    FROM tbl t
    LEFT JOIN pol p
      ON p.schemaname = t.schema_name AND p.tablename = t.table_name
    LEFT JOIN table_grants g
      ON g.table_schema = t.schema_name AND g.table_name = t.table_name
  ),
  $31, (
    SELECT jsonb_agg(
      jsonb_build_object(
        $32, rg.routine_schema,
        $33, rg.routine_name,
        $34, rg.grants
      )
      ORDER BY rg.routine_schema, rg.routine_name
    )
    FROM routine_grants rg
  )
) AS security_dump",1,197.888901,197.888901,197.888901,1
"-- Org Dashboard foundations (service areas, member rates, project invites)

-- [REF: org_dashboard_foundations START]

CREATE TABLE IF NOT EXISTS public.organization_service_areas (
    id uuid DEFAULT gen_random_uuid() NOT NULL,
    organization_id uuid NOT NULL REFERENCES public.organizations(id) ON DELETE CASCADE,
    service_area_text text NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL,
    CONSTRAINT organization_service_areas_pkey PRIMARY KEY (id)
)",1,189.125765,189.125765,189.125765,0
"with table_privileges as (
-- Despite the name `table_privileges`, this includes other kinds of relations:
-- views, matviews, etc. ""Relation privileges"" just doesn't roll off the tongue.
--
-- For each relation, get its relacl in a jsonb format,
-- e.g.
--
-- '{postgres=arwdDxt/postgres}'
--
-- becomes
--
-- [
--   {
--     ""grantee"": ""postgres"",
--     ""grantor"": ""postgres"",
--     ""is_grantable"": false,
--     ""privilege_type"": ""INSERT""
--   },
--   ...
-- ]
select
  c.oid as relation_id,
  nc.nspname as schema,
  c.relname as name,
  case
    when c.relkind = $1 then $2
    when c.relkind = $3 then $4
    when c.relkind = $5 then $6
    when c.relkind = $7 then $8
    when c.relkind = $9 then $10
  end as kind,
  coalesce(
    jsonb_agg(
      jsonb_build_object(
        $11, grantor.rolname,
        $12, grantee.rolname,
        $13, _priv.privilege_type,
        $14, _priv.is_grantable
      )
    ) filter (where _priv is not null),
    $15
  ) as privileges
from pg_class c
join pg_namespace as nc
  on nc.oid = c.relnamespace
left join lateral (
  select grantor, grantee, privilege_type, is_grantable
  from aclexplode(coalesce(c.relacl, acldefault($16, c.relowner)))
) as _priv on $17
left join pg_roles as grantor
  on grantor.oid = _priv.grantor
left join (
  select
    pg_roles.oid,
    pg_roles.rolname
  from pg_roles
  union all
  select
    ($18)::oid as oid, $19
) as grantee (oid, rolname)
  on grantee.oid = _priv.grantee
where c.relkind in ($20, $21, $22, $23, $24)
  and not pg_is_other_temp_schema(c.relnamespace)
  and (
    pg_has_role(c.relowner, $25)
    or has_table_privilege(
      c.oid,
      $26
      || case when current_setting($27)::int4 >= $28 then $29 else $30 end
    )
    or has_any_column_privilege(c.oid, $31)
  )
group by
  c.oid,
  nc.nspname,
  c.relname,
  c.relkind
)
select *
from table_privileges
 where schema NOT IN ($32,$33,$34)

-- source: dashboard
-- user: 8075c1a2-da12-4dce-901d-1b970a3e0101
-- date: 2026-02-01T06:16:21.723Z",22,184.542893045455,547.889806,4059.943647,4573
"with tables as (
SELECT
  c.oid :: int8 AS id,
  nc.nspname AS schema,
  c.relname AS name,
  c.relrowsecurity AS rls_enabled,
  c.relforcerowsecurity AS rls_forced,
  CASE
    WHEN c.relreplident = $1 THEN $2
    WHEN c.relreplident = $3 THEN $4
    WHEN c.relreplident = $5 THEN $6
    ELSE $7
  END AS replica_identity,
  pg_total_relation_size(format($8, nc.nspname, c.relname)) :: int8 AS bytes,
  pg_size_pretty(
    pg_total_relation_size(format($9, nc.nspname, c.relname))
  ) AS size,
  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,
  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,
  obj_description(c.oid) AS comment,
  coalesce(pk.primary_keys, $10) as primary_keys,
  coalesce(
    jsonb_agg(relationships) filter (where relationships is not null),
    $11
  ) as relationships
FROM
  pg_namespace nc
  JOIN pg_class c ON nc.oid = c.relnamespace
  left join (
    select
      c.oid::int8 as table_id,
      jsonb_agg(
        jsonb_build_object(
          $12, c.oid::int8,
          $13, n.nspname,
          $14, c.relname,
          $15, a.attname
        )
        order by array_position(i.indkey, a.attnum)
      ) as primary_keys
    from
      pg_index i
      join pg_class c on i.indrelid = c.oid
      join pg_namespace n on c.relnamespace = n.oid
      join pg_attribute a on a.attrelid = c.oid and a.attnum = any(i.indkey)
    where
      n.nspname IN ($16,$17) AND
      
      i.indisprimary
    group by c.oid
  ) as pk
  on pk.table_id = c.oid
  left join (
    select
      c.oid :: int8 as id,
      c.conname as constraint_name,
      nsa.nspname as source_schema,
      csa.relname as source_table_name,
      sa.attname as source_column_name,
      nta.nspname as target_table_schema,
      cta.relname as target_table_name,
      ta.attname as target_column_name
    from
      pg_constraint c
    join (
      pg_attribute sa
      join pg_class csa on sa.attrelid = csa.oid
      join pg_namespace nsa on csa.relnamespace = nsa.oid
    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)
    join (
      pg_attribute ta
      join pg_class cta on ta.attrelid = cta.oid
      join pg_namespace nta on cta.relnamespace = nta.oid
    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)
    where
      nsa.nspname IN ($18,$19) OR nta.nspname IN ($20,$21) AND
      
      c.contype = $22
  ) as relationships
  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)
  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)
WHERE
  nc.nspname IN ($23,$24) AND
  
  
  c.relkind IN ($25, $26)
  AND NOT pg_is_other_temp_schema(nc.oid)
  AND (
    pg_has_role(c.relowner, $27)
    OR has_table_privilege(
      c.oid,
      $28
    )
    OR has_any_column_privilege(c.oid, $29)
  )
group by
  c.oid,
  c.relname,
  c.relrowsecurity,
  c.relforcerowsecurity,
  c.relreplident,
  nc.nspname,
  pk.primary_keys


)
  
select
  *
  
from tables",80,183.5583317,562.106136,14684.666536,7692
"SELECT
    tbl.schemaname,
    tbl.tablename,
    tbl.quoted_name,
    tbl.is_table,
    json_agg(a) as columns
  FROM
    (
      SELECT
        n.nspname as schemaname,
        c.relname as tablename,
        (quote_ident(n.nspname) || $1 || quote_ident(c.relname)) as quoted_name,
        $2 as is_table
      FROM
        pg_catalog.pg_class c
        JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
      WHERE
        c.relkind = $3
        AND n.nspname not in ($4, $5, $6)
        AND n.nspname not like $7
        AND n.nspname not like $8
        AND has_schema_privilege(n.oid, $9) = $10
        AND has_table_privilege(quote_ident(n.nspname) || $11 || quote_ident(c.relname), $12) = $13
      union all
      SELECT
        n.nspname as schemaname,
        c.relname as tablename,
        (quote_ident(n.nspname) || $14 || quote_ident(c.relname)) as quoted_name,
        $15 as is_table
      FROM
        pg_catalog.pg_class c
        JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace
      WHERE
        c.relkind in ($16, $17)
        AND n.nspname not in ($18, $19, $20)
        AND n.nspname not like $21
        AND n.nspname not like $22
        AND has_schema_privilege(n.oid, $23) = $24
        AND has_table_privilege(quote_ident(n.nspname) || $25 || quote_ident(c.relname), $26) = $27
    ) as tbl
    LEFT JOIN (
      SELECT
        attrelid,
        attname,
        format_type(atttypid, atttypmod) as data_type,
        attnum,
        attisdropped
      FROM
        pg_attribute
    ) as a ON (
      a.attrelid = tbl.quoted_name::regclass
      AND a.attnum > $28
      AND NOT a.attisdropped
      AND has_column_privilege(tbl.quoted_name, a.attname, $29)
    )
  
  GROUP BY schemaname, tablename, quoted_name, is_table",54,175.54380487037,292.478765,9479.365463,11508
"SELECT case when pg_is_in_recovery() then $2 else (pg_walfile_name_offset(lsn)).file_name end, lsn::text, pg_is_in_recovery() FROM pg_backup_start($1, $3) lsn",5,156.6650264,178.818857,783.325132,5
"with jwt as (
  select
    set_config($1, $2, $3) as a,
    set_config($4, $5, $6) as b,
    set_config(
      $7,
      format($8, $9),
      $10
    ) as c
),
check_auth as (
  select auth.uid() as uid
  from jwt
),
p as (
  select public.rpc_org_dashboard_payload(
    $11::uuid,
    $12,
    $13
  ) as payload
  from check_auth
)
select
  (select uid from check_auth) as uid,
  (select payload from p) as payload",1,139.849526,139.849526,139.849526,1
"COPY  ( select schemaname as schema, tablename as table, policyname as policy, permissive, roles, cmd as command, qual as using, with_check as check from pg_policies order by schemaname, tablename, policyname ) TO STDOUT WITH CSV HEADER",2,136.69435,257.34823,273.3887,902
"-- Safe org-scoped profile list for UI pickers

CREATE OR REPLACE FUNCTION public.get_my_org_profiles_minimal()
RETURNS TABLE (
  id uuid,
  email text,
  full_name text,
  avatar_url text
)
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
DECLARE
  v_user_id uuid;
  v_org_id uuid;
BEGIN
  v_user_id := auth.uid();
  IF v_user_id IS NULL THEN
    RAISE EXCEPTION 'Not authenticated';
  END IF;

  SELECT organization_id
    INTO v_org_id
  FROM public.profiles
  WHERE id = v_user_id;

  IF v_org_id IS NULL THEN
    RETURN;
  END IF;

  RETURN QUERY
  SELECT p.id, p.email, p.full_name, p.avatar_url
  FROM public.profiles p
  WHERE p.organization_id = v_org_id;
END;
$$",1,135.089398,135.089398,135.089398,0
"-- Public-safe RPCs for onboarding job titles

create or replace function public.get_job_titles_public()
returns setof public.job_titles
language plpgsql
security definer
set search_path = public
as $$
begin
  return query
  select *
  from public.job_titles
  where deleted_at is null
  order by name asc;
end;
$$",1,117.711826,117.711826,117.711826,0
"-- =======================
-- START PATCH: filter_projects hotfix
-- =======================

CREATE OR REPLACE FUNCTION public.filter_projects(
  _filters jsonb DEFAULT '{}'::jsonb,
  _select_cols text[] DEFAULT NULL::text[],
  _order_by text DEFAULT 'id'::text,
  _direction text DEFAULT 'asc'::text,
  _limit integer DEFAULT NULL::integer,
  _offset integer DEFAULT NULL::integer
) RETURNS SETOF public.projects
LANGUAGE plpgsql STABLE
SET search_path TO 'public', 'pg_temp'
AS $$
DECLARE
  _project_id      uuid;
  _organization_id uuid;
  _where           text := 'deleted_at IS NULL';
  kv               record;
  sqltxt           text;
  dir              text := lower(coalesce(_direction, 'asc'));
  v_text           text;
BEGIN
  -- Normalize filters to an object
  IF _filters IS NULL OR jsonb_typeof(_filters) <> 'object' THEN
    _filters := '{}'::jsonb;
  END IF;

  -- Safe casts (avoid """" -> uuid crash)
  _project_id      := NULLIF(_filters->>'project_id', '')::uuid;
  _organization_id := NULLIF(_filters->>'organization_id', '')::uuid;

  -- Access check (RLS still applies)
  PERFORM check_access('select', 'projects', _project_id, _organization_id);

  -- Build WHERE from filters (ignore special keys)
  FOR kv IN SELECT * FROM jsonb_each(_filters) LOOP
    IF kv.key NOT IN ('project_id', 'organization_id') THEN

      -- JSON null
      IF kv.value = 'null'::jsonb THEN
        _where := _where
          || ' AND ' || quote_ident(kv.key)
          || ' IS NULL';

      ELSIF jsonb_typeof(kv.value) = 'object' THEN
        IF (kv.value ? '$gte') THEN
          _where := _where
            || ' AND ' || quote_ident(kv.key)
            || ' >= '  || quote_literal(kv.value->>'$gte');
        END IF;

        IF (kv.value ? '$lte') THEN
          _where := _where
            || ' AND ' || quote_ident(kv.key)
            || ' <= '  || quote_literal(kv.value->>'$lte');
        END IF;

        IF (kv.value ? '$ilike') THEN
          _where := _where
            || ' AND ' || quote_ident(kv.key)
            || ' ILIKE ' || quote_literal(kv.value->>'$ilike');
        END IF;

        IF (kv.value ? '$in') THEN
          -- col::text = ANY(text[])
          _where := _where
            || ' AND (' || quote_ident(kv.key) || ')::text = ANY ('
            || 'ARRAY(SELECT jsonb_array_elements_text('
            || quote_literal((kv.value->'$in')::text) || '::jsonb)))';
        END IF;

      ELSE
        -- Primitive value: use #>> '{}' to avoid JSON quoting issues
        v_text := kv.value #>> '{}';
        _where := _where
          || ' AND ' || quote_ident(kv.key)
          || ' = '   || quote_literal(v_text);
      END IF;
    END IF;
  END LOOP;

  -- Validate order_by
  IF NOT EXISTS (
    SELECT 1
    FROM information_schema.columns
    WHERE table_schema = 'public'
      AND table_name   = 'projects'
      AND column_name  = _order_by
  ) THEN
    RAISE EXCEPTION 'unknown order_by column'
      USING DETAIL = jsonb_build_object('column', _order_by);
  END IF;

  -- Clamp direction
  IF dir NOT IN ('asc', 'desc') THEN
    dir := 'asc';
  END IF;

  -- Always return full row to match RETURNS SETOF public.projects
  sqltxt := 'SELECT * FROM public.projects WHERE ' || _where
         || ' ORDER BY ' || quote_ident(_order_by) || ' ' || dir;

  IF _limit IS NOT NULL THEN
    sqltxt := sqltxt || ' LIMIT ' || GREATEST(_limit, 0);
  END IF;

  IF _offset IS NOT NULL THEN
    sqltxt := sqltxt || ' OFFSET ' || GREATEST(_offset, 0);
  END IF;

  RETURN QUERY EXECUTE sqltxt;
END;
$$",1,115.277807,115.277807,115.277807,0
"COPY auth.audit_log_entries (instance_id, id, payload, created_at, ip_address) FROM stdin",1,111.033599,111.033599,111.033599,34
"CREATE FUNCTION public.update_documents(_id uuid, _input jsonb) RETURNS SETOF public.documents
    LANGUAGE plpgsql
    SET search_path TO 'public', 'pg_temp'
    AS $$
      DECLARE
        _old_row public.documents;
        _new_row public.documents;
        -- Map only known columns; keys not in the table are ignored safely
        _row     public.documents := (jsonb_populate_record(NULL::public.documents, COALESCE(_input, '{}'::jsonb)));
      BEGIN
        -- Fetch row (RLS decides visibility)
        SELECT * INTO _old_row FROM public.documents WHERE id = _id;
        IF _old_row IS NULL THEN
          RAISE EXCEPTION 'row not found' USING DETAIL = jsonb_build_object('id', _id);
        END IF;

        -- Authorization gate with existing row scope (prevents privilege escalation)
        PERFORM check_access('update','documents', _old_row.project_id, _old_row.organization_id);

        -- Tweak #2: scope columns are excluded from set_list, so they cannot be changed here
        UPDATE public.documents
           SET name = COALESCE(_row.name, name), type = COALESCE(_row.type, type), url = COALESCE(_row.url, url), uploaded_by = COALESCE(_row.uploaded_by, uploaded_by), uploaded_at = COALESCE(_row.uploaded_at, uploaded_at), updated_at = now()
         WHERE id = _id
         RETURNING * INTO _new_row;

        RETURN NEXT _new_row;
      END;
      $$",2,110.0312885,219.722141,220.062577,0
"with tables as (
SELECT
  c.oid :: int8 AS id,
  nc.nspname AS schema,
  c.relname AS name,
  c.relrowsecurity AS rls_enabled,
  c.relforcerowsecurity AS rls_forced,
  CASE
    WHEN c.relreplident = $1 THEN $2
    WHEN c.relreplident = $3 THEN $4
    WHEN c.relreplident = $5 THEN $6
    ELSE $7
  END AS replica_identity,
  pg_total_relation_size(format($8, nc.nspname, c.relname)) :: int8 AS bytes,
  pg_size_pretty(
    pg_total_relation_size(format($9, nc.nspname, c.relname))
  ) AS size,
  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,
  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,
  obj_description(c.oid) AS comment,
  coalesce(pk.primary_keys, $10) as primary_keys,
  coalesce(
    jsonb_agg(relationships) filter (where relationships is not null),
    $11
  ) as relationships
FROM
  pg_namespace nc
  JOIN pg_class c ON nc.oid = c.relnamespace
  left join (
    select
      c.oid::int8 as table_id,
      jsonb_agg(
        jsonb_build_object(
          $12, c.oid::int8,
          $13, n.nspname,
          $14, c.relname,
          $15, a.attname
        )
        order by array_position(i.indkey, a.attnum)
      ) as primary_keys
    from
      pg_index i
      join pg_class c on i.indrelid = c.oid
      join pg_namespace n on c.relnamespace = n.oid
      join pg_attribute a on a.attrelid = c.oid and a.attnum = any(i.indkey)
    where
      i.indisprimary
    group by c.oid
  ) as pk
  on pk.table_id = c.oid
  left join (
    select
      c.oid :: int8 as id,
      c.conname as constraint_name,
      nsa.nspname as source_schema,
      csa.relname as source_table_name,
      sa.attname as source_column_name,
      nta.nspname as target_table_schema,
      cta.relname as target_table_name,
      ta.attname as target_column_name
    from
      pg_constraint c
    join (
      pg_attribute sa
      join pg_class csa on sa.attrelid = csa.oid
      join pg_namespace nsa on csa.relnamespace = nsa.oid
    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)
    join (
      pg_attribute ta
      join pg_class cta on ta.attrelid = cta.oid
      join pg_namespace nta on cta.relnamespace = nta.oid
    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)
    where
      c.contype = $16
  ) as relationships
  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)
  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)
WHERE
  c.relkind IN ($17, $18)
  AND NOT pg_is_other_temp_schema(nc.oid)
  AND (
    pg_has_role(c.relowner, $19)
    OR has_table_privilege(
      c.oid,
      $20
    )
    OR has_any_column_privilege(c.oid, $21)
  )
group by
  c.oid,
  c.relname,
  c.relrowsecurity,
  c.relforcerowsecurity,
  c.relreplident,
  nc.nspname,
  pk.primary_keys
)
  , columns as (
-- Adapted from information_schema.columns

SELECT
  c.oid :: int8 AS table_id,
  nc.nspname AS schema,
  c.relname AS table,
  (c.oid || $22 || a.attnum) AS id,
  a.attnum AS ordinal_position,
  a.attname AS name,
  CASE
    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)
    ELSE $23
  END AS default_value,
  CASE
    WHEN t.typtype = $24 THEN CASE
      WHEN bt.typelem <> $25 :: oid
      AND bt.typlen = $26 THEN $27
      WHEN nbt.nspname = $28 THEN format_type(t.typbasetype, $29)
      ELSE $30
    END
    ELSE CASE
      WHEN t.typelem <> $31 :: oid
      AND t.typlen = $32 THEN $33
      WHEN nt.nspname = $34 THEN format_type(a.atttypid, $35)
      ELSE $36
    END
  END AS data_type,
  COALESCE(bt.typname, t.typname) AS format,
  a.attidentity IN ($37, $38) AS is_identity,
  CASE
    a.attidentity
    WHEN $39 THEN $40
    WHEN $41 THEN $42
    ELSE $43
  END AS identity_generation,
  a.attgenerated IN ($44) AS is_generated,
  NOT (
    a.attnotnull
    OR t.typtype = $45 AND t.typnotnull
  ) AS is_nullable,
  (
    c.relkind IN ($46, $47)
    OR c.relkind IN ($48, $49) AND pg_column_is_updatable(c.oid, a.attnum, $50)
  ) AS is_updatable,
  uniques.table_id IS NOT NULL AS is_unique,
  check_constraints.definition AS ""check"",
  array_to_json(
    array(
      SELECT
        enumlabel
      FROM
        pg_catalog.pg_enum enums
      WHERE
        enums.enumtypid = coalesce(bt.oid, t.oid)
        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)
      ORDER BY
        enums.enumsortorder
    )
  ) AS enums,
  col_description(c.oid, a.attnum) AS comment
FROM
  pg_attribute a
  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid
  AND a.attnum = ad.adnum
  JOIN (
    pg_class c
    JOIN pg_namespace nc ON c.relnamespace = nc.oid
  ) ON a.attrelid = c.oid
  JOIN (
    pg_type t
    JOIN pg_namespace nt ON t.typnamespace = nt.oid
  ) ON a.atttypid = t.oid
  LEFT JOIN (
    pg_type bt
    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid
  ) ON t.typtype = $51
  AND t.typbasetype = bt.oid
  LEFT JOIN (
    SELECT DISTINCT ON (table_id, ordinal_position)
      conrelid AS table_id,
      conkey[$52] AS ordinal_position
    FROM pg_catalog.pg_constraint
    WHERE contype = $53 AND cardinality(conkey) = $54
  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum
  LEFT JOIN (
    -- We only select the first column check
    SELECT DISTINCT ON (table_id, ordinal_position)
      conrelid AS table_id,
      conkey[$55] AS ordinal_position,
      substring(
        pg_get_constraintdef(pg_constraint.oid, $56),
        $57,
        length(pg_get_constraintdef(pg_constraint.oid, $58)) - $59
      ) AS ""definition""
    FROM pg_constraint
    WHERE contype = $60 AND cardinality(conkey) = $61
    ORDER BY table_id, ordinal_position, oid asc
  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum
WHERE
  NOT pg_is_other_temp_schema(nc.oid)
  AND a.attnum > $62
  AND NOT a.attisdropped
  AND (c.relkind IN ($63, $64, $65, $66, $67))
  AND (
    pg_has_role(c.relowner, $68)
    OR has_column_privilege(
      c.oid,
      a.attnum,
      $69
    )
  )
)
  select
    *
    , 
COALESCE(
  (
    SELECT
      array_agg(row_to_json(columns)) FILTER (WHERE columns.table_id = tables.id)
    FROM
      columns
  ),
  $70
) AS columns
  from tables where name = $71 and schema = $72",30,108.5202711,205.438253,3255.608133,30
"COPY storage.buckets (id, name, owner, created_at, updated_at, public, avif_autodetection, file_size_limit, allowed_mime_types, owner_id) FROM stdin",1,106.702244,106.702244,106.702244,2
"COPY auth.sso_domains (id, sso_provider_id, domain, created_at, updated_at) FROM stdin",2,103.9044765,104.666803,207.808953,0
"COPY public.crews (id, project_id, name, created_at, updated_at, deleted_at) FROM stdin",2,103.190696,107.763366,206.381392,0
"COPY public.bid_vendors (id, bid_package_id, vendor_id, invited_at, created_at, updated_at, deleted_at) FROM stdin",2,103.031206,103.208161,206.062412,0
"COPY public.hr_documents (id, employee_id, document_type, url, uploaded_at, created_at, updated_at, deleted_at) FROM stdin",2,102.836859,110.852408,205.673718,0
"COPY public.general_ledger (id, project_id, entry_date, description, debit, credit, balance, created_at, updated_at, deleted_at) FROM stdin",2,102.7317695,111.358102,205.463539,0
"COPY public.estimate_line_items (id, estimate_id, cost_code_id, name, unit_measure, quantity, unit_price, total_cost, created_at, updated_at, deleted_at) FROM stdin",2,102.0006045,103.951377,204.001209,0
"COPY public.inspections (id, project_id, name, inspection_type, date, status, result, notes, created_at, updated_at, deleted_at) FROM stdin",2,101.988234,108.352564,203.976468,0
"COPY public.reports (id, project_id, report_type, generated_at, created_at, updated_at, deleted_at) FROM stdin",2,101.349814,104.02735,202.699628,0
"COPY public.equipment_assignments (id, equipment_id, project_id, assigned_to, assigned_date, released_date, notes, created_at, updated_at, deleted_at) FROM stdin",2,101.258962,103.113763,202.517924,0
"COPY public.bids (id, bid_package_id, vendor_id, amount, submitted_at, status, created_at, updated_at, deleted_at) FROM stdin",2,101.2571065,103.900791,202.514213,0
"COPY public.accounts_payable (id, project_id, amount_due, due_date, status, created_at, updated_at, deleted_at) FROM stdin",2,101.2255565,103.772709,202.451113,0
"COPY public.vendor_contacts (id, vendor_id, name, email, phone, created_at, updated_at, deleted_at) FROM stdin",2,101.012695,103.267842,202.02539,0
"COPY public.cost_codes (id, code, description, created_at, updated_at, deleted_at) FROM stdin",2,101.0073945,103.32245,202.014789,0
"COPY public.sensor_data (id, project_id, data, collected_at, created_at, updated_at, deleted_at) FROM stdin",2,100.9973285,102.47602,201.994657,0
"COPY public.workflows (id, entity_schema, entity_table, entity_id, workflow_name, current_state, created_at, updated_at, deleted_at) FROM stdin",2,100.9899145,103.205074,201.979829,0
"COPY public.rfis (id, project_id, subject, status, question, answer, submitted_by, reviewed_by, submitted_at, reviewed_at, created_at, updated_at, deleted_at) FROM stdin",2,100.9886565,103.240863,201.977313,0
"COPY public.activity_logs (id, profile_id, activity_type, activity_at, created_at, updated_at, deleted_at) FROM stdin",2,100.97861,103.969483,201.95722,0
"COPY public.line_item_templates (id, name, formula, variables, created_by, created_at, updated_at, deleted_at) FROM stdin",2,100.9261515,103.91475,201.852303,0
"COPY public.wbs (id, project_id, name, location, order_num, created_at, updated_at, deleted_at) FROM stdin",2,100.871852,103.079578,201.743704,0
"COPY public.crew_assignments (id, crew_id, profile_id, assigned_date, created_at, updated_at, deleted_at) FROM stdin",2,100.8546245,103.134612,201.709249,0
"COPY public.meeting_minutes (id, project_id, meeting_date, notes, created_by, created_at, updated_at, deleted_at) FROM stdin",2,100.6842815,103.245174,201.368563,0
"COPY public.profiles (id, email, full_name, phone, job_title_id, organization_id, avatar_url, created_at, updated_at, role, deleted_at) FROM stdin",2,100.625462,102.487678,201.250924,2
"COPY auth.instances (id, uuid, raw_base_config, created_at, updated_at) FROM stdin",2,100.6177125,103.226005,201.235425,0
"COPY public.vendor_qualifications (id, vendor_id, qualification_type, status, reviewed_at, created_at, updated_at, deleted_at) FROM stdin",2,100.5314485,103.15837,201.062897,0
"COPY public.line_item_entries (id, line_item_id, date, quantity_completed, notes, created_at, updated_at, deleted_at) FROM stdin",2,100.297567,103.2202,200.595134,0
"COPY public.maps (id, wbs_id, project_id, name, description, coordinates, scope, order_num, created_at, updated_at, deleted_at) FROM stdin",2,100.245936,104.799331,200.491872,0
"COPY public.estimates (id, project_id, name, status, created_by, created_at, updated_at, deleted_at) FROM stdin",2,100.213311,102.488242,200.426622,0
"COPY public.compliance_checks (id, project_id, check_date, description, result, created_at, updated_at, deleted_at) FROM stdin",2,100.175739,103.10024,200.351478,0
"COPY auth.mfa_challenges (id, factor_id, created_at, verified_at, ip_address, otp_code, web_authn_session_data) FROM stdin",2,100.1375625,103.138458,200.275125,0
"COPY public.subcontractor_agreements (id, subcontract_id, agreement_url, signed_at, created_at, updated_at, deleted_at) FROM stdin",2,99.9039435,104.654816,199.807887,0
"COPY public.financial_documents (id, project_id, document_type, url, uploaded_at, created_at, updated_at, deleted_at) FROM stdin",2,99.849302,104.678428,199.698604,0
"COPY public.tack_rates (id, project_id, rate, material_type, created_at, updated_at, deleted_at) FROM stdin",2,99.832495,101.546485,199.66499,0
"COPY public.audit_log (id, table_name, action, row_id, before_data, after_data, changed_by, changed_at, deleted_at) FROM stdin",2,99.7842675,103.065844,199.568535,0
"SELECT
  e.name,
  n.nspname AS schema,
  e.default_version,
  x.extversion AS installed_version,
  e.comment
FROM
  pg_available_extensions() e(name, default_version, comment)
  LEFT JOIN pg_extension x ON e.name = x.extname
  LEFT JOIN pg_namespace n ON x.extnamespace = n.oid
WHERE
  $1",100,99.67864957,316.835546,9967.864957,7800
"COPY public.equipment_maintenance (id, equipment_id, maintenance_date, type, description, performed_by, created_at, updated_at, deleted_at) FROM stdin",2,99.463506,103.164462,198.927012,0
"COPY realtime.subscription (id, subscription_id, entity, filters, claims, created_at) FROM stdin",2,99.4489215,100.152143,198.897843,0
"COPY public.safety_incidents (id, project_id, incident_date, description, reported_by, severity, resolved, created_at, updated_at, deleted_at) FROM stdin",2,99.3453095,103.06347,198.690619,0
"COPY public.user_projects (id, user_id, project_id, role, created_at, updated_at, deleted_at) FROM stdin",2,99.1600695,103.175814,198.320139,0
"COPY auth.saml_relay_states (id, sso_provider_id, request_id, for_email, redirect_to, created_at, updated_at, flow_state_id) FROM stdin",2,99.1385155,99.562381,198.277031,0
"COPY public.task_dependencies (id, task_id, depends_on_task_id, created_at, deleted_at) FROM stdin",2,99.132069,102.400731,198.264138,0
"COPY public.avatars (id, url, created_at, updated_at, deleted_at) FROM stdin",2,99.115221,103.966743,198.230442,0
"COPY auth.mfa_factors (id, user_id, friendly_name, factor_type, status, created_at, updated_at, secret, phone, last_challenged_at, web_authn_credential, web_authn_aaguid) FROM stdin",2,99.090762,99.429246,198.181524,0
"COPY public.materials (id, organization_id, name, description, unit, created_at, updated_at, deleted_at) FROM stdin",2,99.0780935,99.630832,198.156187,0
"COPY public.vendor_documents (id, vendor_id, document_type, url, uploaded_at, created_at, updated_at, deleted_at) FROM stdin",2,99.0703345,99.378792,198.140669,0
"COPY public.accounts_receivable (id, project_id, amount_due, due_date, status, created_at, updated_at, deleted_at) FROM stdin",2,99.0671665,103.27019,198.134333,0
"COPY public.daily_logs (id, project_id, date, weather, notes, created_at, updated_at, deleted_at) FROM stdin",2,99.035697,99.361033,198.071394,0
"COPY auth.identities (provider_id, user_id, identity_data, provider, last_sign_in_at, created_at, updated_at, id) FROM stdin",2,99.0258625,99.488222,198.051725,0
"COPY auth.flow_state (id, user_id, auth_code, code_challenge_method, code_challenge, provider_type, provider_access_token, provider_refresh_token, created_at, updated_at, authentication_method, auth_code_issued_at) FROM stdin",2,99.0232145,103.023291,198.046429,0
"COPY auth.mfa_amr_claims (session_id, created_at, updated_at, authentication_method, id) FROM stdin",2,99.008733,103.181295,198.017466,0
"COPY public.organization_projects (id, organization_id, project_id, created_at, updated_at, deleted_at) FROM stdin",2,99.003132,99.318153,198.006264,0
"COPY auth.refresh_tokens (instance_id, id, token, user_id, revoked, created_at, updated_at, parent, session_id) FROM stdin",2,98.947378,99.36111,197.894756,0
"COPY public.labor_records (id, line_item_id, worker_count, hours_worked, work_date, work_type, notes, created_at, updated_at, deleted_at) FROM stdin",2,98.9292225,99.371704,197.858445,0
"COPY public.material_inventory (id, material_id, organization_id, quantity, last_updated, created_at, updated_at, deleted_at) FROM stdin",2,98.928901,102.343097,197.857802,0
"COPY auth.sso_providers (id, resource_id, created_at, updated_at) FROM stdin",2,98.885203,99.914739,197.770406,0
"COPY public.vendors (id, organization_id, name, status, contact_email, contact_phone, created_at, updated_at, deleted_at) FROM stdin",2,98.7803365,103.249249,197.560673,0
"COPY public.change_orders (id, project_id, number, description, status, amount, created_at, updated_at, deleted_at) FROM stdin",2,98.7662585,98.798355,197.532517,0
"COPY public.photos (id, project_id, url, caption, uploaded_by, uploaded_at, created_at, updated_at, deleted_at) FROM stdin",2,98.7259615,98.798059,197.451923,0
"COPY public.bid_packages (id, project_id, name, status, created_by, created_at, updated_at, deleted_at) FROM stdin",2,98.715568,98.786265,197.431136,0
"COPY public.bim_models (id, project_id, name, url, uploaded_at, created_at, updated_at, deleted_at) FROM stdin",2,98.7117465,103.064154,197.423493,0
"COPY public.commitments (id, project_id, vendor_id, type, amount, status, created_at, updated_at, deleted_at) FROM stdin",2,98.7070115,103.115353,197.414023,0
"COPY public.material_receipts (id, material_order_id, received_date, quantity, received_by, created_at, updated_at, deleted_at) FROM stdin",2,98.7029815,98.706456,197.405963,0
"COPY public.crew_members (id, crew_id, profile_id, role, start_date, end_date, created_at, updated_at, deleted_at) FROM stdin",2,98.6990605,98.739759,197.398121,0
"COPY public.drawing_versions (id, document_id, version, uploaded_by, uploaded_at, created_at, updated_at, deleted_at) FROM stdin",2,98.683518,103.134743,197.367036,0
"COPY public.dashboard_configs (id, profile_id, config, created_at, updated_at, deleted_at) FROM stdin",2,98.6810585,98.724536,197.362117,0
"COPY public.training_records (id, employee_id, training_type, completion_date, created_at, updated_at, deleted_at) FROM stdin",2,98.663368,98.676634,197.326736,0
"COPY public.certifications (id, employee_id, certification_type, issue_date, expiry_date, created_at, updated_at, deleted_at) FROM stdin",2,98.6559805,103.158594,197.311961,0
"COPY auth.users (instance_id, id, aud, role, email, encrypted_password, email_confirmed_at, invited_at, confirmation_token, confirmation_sent_at, recovery_token, recovery_sent_at, email_change_token_new, email_change, email_change_sent_at, last_sign_in_at, raw_app_meta_data, raw_user_meta_data, is_super_admin, created_at, updated_at, phone, phone_confirmed_at, phone_change, phone_change_token, phone_change_sent_at, email_change_token_current, email_change_confirm_status, banned_until, reauthentication_token, reauthentication_sent_at, is_sso_user, deleted_at, is_anonymous) FROM stdin",2,98.6528365,102.373345,197.305673,0
"COPY auth.saml_providers (id, sso_provider_id, entity_id, metadata_xml, metadata_url, attribute_mapping, created_at, updated_at, name_id_format) FROM stdin",2,98.617569,98.653057,197.235138,0
"COPY public.audit_logs (id, project_id, action, performed_by, performed_at, created_at, updated_at, deleted_at) FROM stdin",2,98.6151865,100.978198,197.230373,0
"COPY public.job_titles (id, name, created_at, updated_at, deleted_at) FROM stdin",2,98.60715,98.828301,197.2143,0
"COPY public.project_inspectors (project_id, profile_id, assigned_by, assigned_at, deleted_at) FROM stdin",2,98.3914115,100.102467,196.782823,0
"COPY public.projects (id, organization_id, name, description, status, start_date, end_date, created_at, updated_at, deleted_at) FROM stdin",2,98.381776,98.711193,196.763552,0
"COPY public.integration_tokens (id, profile_id, service_name, token, created_at, updated_at, deleted_at) FROM stdin",2,98.3527905,102.481523,196.705581,0
"COPY auth.one_time_tokens (id, user_id, token_type, token_hash, relates_to, created_at, updated_at) FROM stdin",2,98.3484635,98.649517,196.696927,0
"COPY public.progress_billings (id, project_id, billing_number, amount, status, created_at, updated_at, deleted_at) FROM stdin",2,98.3037135,101.629248,196.607427,0
"COPY public.task_status_logs (task_id, status, changed_at, deleted_at) FROM stdin",2,98.2796635,98.631252,196.559327,0
