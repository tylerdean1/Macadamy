# AI Contribution Guidelines for Codex

These guidelines merge repository instructions and AI contribution expectations to help agents work effectively:

- Run `npm test` and fix any failures before committing.
- Follow the established code style and adhere to ESLint rules from `eslint.config.js`.
- Use clear, descriptive commit messages.
- Document new components in `README.md` and update documentation or comments when behavior changes.
- Any codebase change must be reflected in `README.md` within the same work session/PR.
- Consult `src/lib/database.types.ts` for backend types and definitions before making changes.
- Ensure all data access uses RPC functionsâ€”avoid direct table calls.
- Maintain strict type safety in accordance with `database.types.ts`.
- Add comments to code explaining the purpose of major code blocks and reasoning where appropriate.
- Network access to external resources is already granted in the environment settings.

## Autogenerated Files (fulldb)

The following files are generated by `npm run fulldb` (or scripts inside that chain) and must not be manually edited:

- `src/lib/database.types.ts`
- `src/lib/rpc.definitions.ts`
- `src/lib/tables.rpc.ts`
- `src/lib/database.policies.ts`
- `src/lib/functions.sql`
- `backend.snapshot.md`
- `backend.snapshot.sql`

When checking backend behavior, schema, RPC contracts, function bodies, or policies, treat these autogenerated files as the read-only source of truth.

If changes are required to database functions/RPC behavior/schema represented in these files, do **not** edit generated outputs directly.

Use a migration file in `supabase/migrations/` and then regenerate outputs with `npm run fulldb`.

## Migration Delivery Workflow (Project Preference)

For this project, prefer delivering migration SQL directly in chat by default.

- Default behavior: provide SQL snippets in chat for the user to apply manually.
- Only create files in `supabase/migrations/` when the user explicitly asks for a file.
- It is acceptable in this workflow for applied migration files to be deleted by the user afterward to avoid re-running the same migration.
- When SQL is delivered in chat, clearly label it as a migration and include a short purpose line.
- Assume the user runs the migration and `npm run fulldb` after every backend/query change.
- Do not remind the user to run migrations or `npm run fulldb` unless they explicitly ask for run steps.

## Migration Naming Convention

Migration filenames must use a timestamp prefix and a brief description only:

- Format: `<brief_description>.sql`
- Keep `<brief_description>` short and focused (for example: `fix_member_filter_shape`)
- Avoid long, sentence-like migration names
